/*! 
  author: tcly861204
  email: tcly861204@hotmail.com
  date: 6/4/2022, 12:01:20 AM
  github: https://github.com/tcly861204/vite-react-hooks-bigdata
 */
var q=Object.defineProperty,P=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var H=(t,e,n)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,R=(t,e)=>{for(var n in e||(e={}))K.call(e,n)&&H(t,n,e[n]);if(F)for(var n of F(e))U.call(e,n)&&H(t,n,e[n]);return t},T=(t,e)=>P(t,J(e));import{P as m,R as l,r as i,S as Y,a as G}from"./vendor.f8a16bfd.js";const Q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}};Q();const D=t=>{const{value:e,callback:n}=t;return l.createElement("label",{className:["cui_checkbox",e&&"is-checked"].join(" ")},l.createElement("span",{onClick:s=>{n&&typeof n=="function"&&n(),s.preventDefault()},className:["cui_checkbox__input",e&&"is-checked"].join(" ")},l.createElement("span",{className:"cui_checkbox__inner"}),l.createElement("input",{type:"checkbox","aria-hidden":"false",className:"cui_checkbox__original"})))};D.propTypes={value:m.bool,callback:m.func};const z=function(){return document.addEventListener?function(t,e,n){t&&e&&n&&t.addEventListener(e,n,!1)}:function(t,e,n){t&&e&&n&&t.attachEvent("on"+e,n)}}(),M=function(){return document.removeEventListener?function(t,e,n){t&&e&&t.removeEventListener(e,n,!1)}:function(t,e,n){t&&e&&t.detachEvent("on"+e,n)}}();function j(t){const{columns:e,callback:n,handleSelected:s}=t,o=i.exports.useRef(null),[u,h]=i.exports.useState(!1);i.exports.useEffect(()=>{let a=null,c=null,r=null,y=null,p=null,d=null;const g=function(f){a=f.clientX,p=f.target.parentNode.parentNode.parentNode.parentNode,y=JSON.parse(JSON.stringify(p.getBoundingClientRect())),d=document.createElement("div"),d.className="resize-line",p.appendChild(d),z(document,"mousemove",v),z(document,"mouseup",S)},v=function(f){d.style.left=`${f.clientX-y.left-2}px`,c=f.clientX},S=function(){M(r.target,"mousedown",g),M(document,"mousemove",v),M(document,"mouseup",S),d.parentNode.removeChild(d);const f=r.target.dataset.field;n(f,r.target.offsetWidth+1+(c-a))},$=function(f){f.target.nodeName.toLocaleLowerCase()==="li"&&f.offsetX>8&&f.target.className.includes("__resize")?(f.target.style.cursor="col-resize",r=f,z(f.target,"mousedown",g)):(f.target.nodeName.toLocaleLowerCase()==="li"||f.target.nodeName.toLocaleLowerCase()==="div")&&(f.target.style.cursor="default")};return z(o.current,"mousemove",$),()=>{M(o.current,"mousemove",$)}},[o]);const b=i.exports.useCallback(()=>{h(a=>(a=!a,s&&typeof s=="function"&&s(a),a))},[u,s]);return l.createElement("div",{className:"table-header",ref:o},e.map((a,c)=>{const r=a.width,y={width:`${r}px`,maxWidth:`${r}px`,minWidth:`${r}px`,padding:"0 8px",boxSizing:"border-box"};return l.createElement("li",{className:[`align-${a.headerAlign||a.align||"left"}`,a.resizable&&"__resize"].join(" "),"data-field":a.prop||null,style:a.width?y:{flex:1,padding:"0 8px",boxSizing:"border-box"},key:c},l.createElement("div",null,a.type==="selection"?l.createElement(D,{value:u,callback:b}):a.label))}))}j.propTypes={columns:m.array,callback:m.func,handleSelected:m.func};var O=l.memo(j);function W(t){const{data:e,scrollTop:n,maxRow:s,columns:o,deleteCallback:u}=t,h=e.length>15?15:e.length,b=function(c,r){if(c.component&&c.type!=="delete")return l.createElement(c.component,{index:r});if(c.prop)return l.createElement("div",{className:"cell line-clamp"},e[r][c.prop]);switch(c.type){case"index":return l.createElement("div",{className:"cell"},r+1);case"selection":return l.createElement("div",{className:"cell"},l.createElement(D,{value:e[r]._checked||!1}));case"delete":return c.component?l.createElement(c.component,{index:r,callback:u}):null;default:return null}},a=i.exports.useCallback(function(){const c=[];let r=0;const y="cui-bigdata-container",p=e.length;p>s?n<p-s-4?r=n+s+3:r=p:r=e.length;for(let d=n;d<r;d++)c.push(l.createElement("div",{key:d,className:`${y}-row`,style:{transform:`translateY(${d*36}px)`}},o.map((g,v)=>l.createElement("li",{key:v,className:`align-${g.align||"left"}`,style:g.width?{width:`${g.width}px`,maxWidth:`${g.width}px`,minWidth:`${g.width}px`}:{display:1}},b(g,d)))));return c},[n,e]);return l.createElement("div",{className:"table-body",style:{height:`${h*36}px`}},a())}W.propTypes={data:m.array.isRequired,scrollTop:m.number.isRequired,maxRow:m.number.isRequired,columns:m.array,deleteCallback:m.func};const V=function(t){const[e,n]=i.exports.useState([]),[s,o]=i.exports.useState([]),[u,h]=i.exports.useState([]);i.exports.useEffect(()=>{n(t.filter(c=>c.fixed==="left")),o(t.filter(c=>c.fixed==="right")),h(t.filter(c=>!["left","right"].includes(c.fixed)))},[t]);const b=i.exports.useMemo(()=>e.reduce((c,r)=>c+(r.width||100),0),[e]),a=i.exports.useMemo(()=>s.reduce((c,r)=>c+(r.width||100),0),[s]);return[e,u,s,b,a]};const I=t=>{const{data:e,handleSelected:n}=t,s=i.exports.useRef(null),[o,u]=i.exports.useState(t.columns||[]),[h,b]=i.exports.useState(8),[a,c]=i.exports.useState(0),[r,y]=i.exports.useState(0),[p]=i.exports.useState(t.rowHeight||36),[d]=i.exports.useState(t.maxRow||15),[g,v]=i.exports.useState(!1),[S,$,f,C,k]=V(o);i.exports.useEffect(()=>{const E=setTimeout(()=>{const w=s.current.clientWidth,N=s.current.parentNode.clientWidth;b(N-w)},30);return()=>{clearTimeout(E)}},[e,s]),i.exports.useEffect(()=>{v(e.length>d)},[e,d]);const A=i.exports.useCallback(function(E,w){if(!E)return;const N=o.findIndex(L=>L.prop===E);if(N>=0){const L=[...o];L[N].width=w<20?20:w,u(L)}},[o]),x="cui-bigdata-container",B=i.exports.useMemo(()=>((e.length>d?d:e.length)+1)*p,[e,d,p]),X=function(E){const w=E.currentTarget.scrollTop,N=E.currentTarget.scrollLeft;w!==a&&c(Math.floor(w/p)),N!==r&&y(N)},_=i.exports.useMemo(()=>e.length*p,[e,p]);return l.createElement("section",{className:x,style:{height:`${B+2}px`}},l.createElement("section",{className:`${x}-header`},l.createElement("div",{className:`${x}_left`,style:{width:`${C}px`}},l.createElement(O,{columns:S,callback:A,handleSelected:n})),l.createElement("div",{className:`${x}_content`,style:{left:`${C-r}px`,right:`${k+(g?h:0)-r}px`}},l.createElement(O,{handleSelected:n,columns:$,callback:A})),l.createElement("div",{className:`${x}_right`,style:{width:`${k+(g?h:0)}px`,right:0}},l.createElement(O,{columns:f,callback:A}))),l.createElement("section",{className:`${x}-body`,style:{height:`${B-36}px`},onScroll:X,ref:s},l.createElement("div",{className:`${x}_left`,style:{width:`${C}px`,left:`${r}px`,height:`${_}px`}},l.createElement(W,T(R({},t),{maxRow:d,scrollTop:a,columns:S}))),l.createElement("div",{className:`${x}_content`,style:{left:`${C}px`,right:`${k-r}px`,height:`${_}px`}},l.createElement(W,T(R({},t),{maxRow:d,scrollTop:a,columns:$}))),l.createElement("div",{className:`${x}_right`,style:{width:`${k}px`,right:`${0-r}px`,height:`${_}px`}},l.createElement(W,T(R({},t),{maxRow:d,scrollTop:a,columns:f}))),l.createElement("div",{className:`${x}_scroll`,style:{height:`${_}px`}})))};I.propTypes={data:m.array,handleSelected:m.func,columns:m.array,rowHeight:m.number,maxRow:m.number};class Z extends i.exports.Component{constructor(e){super(e);this.state={loading:!1,columns:[{type:"selection",align:"center",fixed:"left",width:50},{label:"\u5E8F\u53F7",type:"index",fixed:"left",headerAlign:"center",align:"center",width:60},{label:"\u6807\u9898",prop:"title",fixed:"left",width:180,resizable:!0},{label:"\u59D3\u540D",prop:"name",width:120,resizable:!0},{label:"\u5730\u533A",prop:"region",width:100},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:150,resizable:!0},{label:"\u59D3\u522B",prop:"sex",width:140,resizable:!0},{label:"\u64CD\u4F5C",headerAlign:"center",type:"delete",width:56,resizable:!1,fixed:"right",component:n=>{const{index:s,callback:o}=n;return l.createElement("div",{onClick:()=>{o&&typeof o=="function"&&o(s)},style:{textAlign:"center",fontSize:"13px",cursor:"pointer",color:"#409eff"}},"\u5220\u9664")}}],data:[]}}componentDidMount(){this.setState({loading:!0}),fetch("./public/data.json").then(e=>e.json()).then(e=>{e.msg==="OK"&&this.setState({loading:!1,data:e.data.list})})}render(){const{loading:e,columns:n,data:s}=this.state;return l.createElement("section",{style:{padding:"50px"}},l.createElement(Y,{spinning:e},l.createElement(I,{columns:n,data:s,deleteCallback:o=>{s.splice(o,1),this.setState({data:s})},handleSelected:o=>{this.setState({data:s.map(u=>(u._checked=o,u))})}})))}}G.render(l.createElement(l.StrictMode,null,l.createElement(Z,null)),document.getElementById("root"));
